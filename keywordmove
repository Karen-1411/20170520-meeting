Sub keywordmove()

    Dim keyword As String
    Dim r, c, ccountall, decision, i, rcountall, rcount, rcountt As Integer
    
    ccountall = ActiveSheet.Cells(4, Columns.Count).End(xlToLeft).Column
    
    keyword = Application.InputBox(prompt:="關鍵字是？", Title:="移動項目")
    decision = Application.InputBox(prompt:="想換到哪一欄？", Title:="移動項目", Type:=1)

    If IsNumeric(decision) = False Then

        MsgBox "輸入錯誤！"
        Exit Sub

    ElseIf decision > 29 Or decision <= 0 Then

        MsgBox "輸入錯誤！"
       Exit Sub

    Else

        For i = 1 To ccountall Step 3

            If decision = ActiveSheet.Cells(3, i).Value Then
                Exit For
            End If

        Next
        
    End If
    
    
    For c = 2 To ccountall - 1 Step 3
    
        rcountall = ActiveSheet.Cells(Rows.Count, c).End(xlUp).Row
    
        For r = 5 To rcountall Step 1
        
            If ActiveSheet.Cells(r, c).Value Like "*" & keyword & "*" Then
                
                '先放到最後一欄
                rcount = ActiveSheet.Cells(Rows.Count, ccountall + 1).End(xlUp).Row
                
                Range(Cells(r, c - 1), Cells(r, c + 1)).Cut
                Cells(rcount + 1, ccountall + 1).Select
                
                Selection.Insert Shift:=xlDown
                Range(Cells(r, c - 1), Cells(r, c + 1)).Delete Shift:=xlUp
                
                r = r - 1
                
            ElseIf r = rcountall And c = ccountall Then
                MsgBox "找不到此關鍵字？"
            End If
        
        Next
    
    Next
    
    rcount = ActiveSheet.Cells(Rows.Count, ccountall + 1).End(xlUp).Row
    rcountt = ActiveSheet.Cells(Rows.Count, i).End(xlUp).Row
    
    Range(Cells(2, ccountall + 1), Cells(rcount, ccountall + 3)).Cut
    Cells(rcountt + 1, i).Select
    Selection.Insert Shift:=xlDown

End Sub

